{"version":3,"sources":["scrolls/pl-scrolls.js"],"names":["window","Ractive","controller","component","data","el","config","done","_update","area","_$el","container","prop","max","vertical","outerHeight","height","Scrolls","set","_scroll","scrollTop","top","_topPX","verticalTicker","offset","_mousedown","event","_inDrag","pageY","preventDefault","stopPropagation","_mousemove","_mouseup","_mouseenter","_mouseleave","PAGE_SIZE","_mousewheelBinds","document","documentMode","plScrollsWidth","$tester","$","css","overflow","visibility","width","html","append","Math","ceil","find","remove","sheet","styleSheets","insertRule","cssRules","length","addRule","plName","extend","active","hover","inDrag","enter","update","body","scrolls","next","on","off","scroll","mouseenter","mouseleave","click","target","stop","animate","offsetY","easing","each","i","bind","cloneEvent","WheelEvent","originalEvent","createEvent","dispatchEvent","fireEvent","eventType","mousedown","mousemove","mouseup"],"mappings":"CAAA,WACE,YAEAA,QAAOC,QAAQC,WAAW,aAAc,SAASC,EAAWC,EAAMC,EAAIC,EAAQC,GAmC5E,QAASC,KACP,GAAIC,GAAOC,EAAKC,UAAUC,KAAK,gBAC3BC,EAAMH,EAAKI,SAASC,cACpBC,EAAe,IAANH,EAAYJ,CAEzBQ,GAAQC,IAAI,SAAUT,EAAOI,GAC7BI,EAAQC,IAAI,SAAUF,GACtBG,IAGF,QAASA,KACP,GAAIV,GAAOC,EAAKC,UAAUC,KAAK,gBAC3BQ,EAAYV,EAAKC,UAAUS,YAC3BC,EAAkB,IAAZD,EAAkBX,CAE5BQ,GAAQC,IAAI,MAAOG,GAGrB,QAASC,KACP,MAAOZ,GAAKa,eAAeC,SAASH,IAAMX,EAAKI,SAASU,SAASH,IAGnE,QAASI,GAAWC,GAClBC,GACEP,UAAWV,EAAKC,UAAUS,YAC1BQ,MAAOF,EAAME,OAGfX,EAAQC,IAAI,UAAU,GAEtBQ,EAAMG,iBACNH,EAAMI,kBAGR,QAASC,GAAWL,GAClB,GAAKC,EAAL,CAIA,GAAIlB,GAAOC,EAAKC,UAAUC,KAAK,gBAC3BC,EAAMH,EAAKI,SAASC,cACpBK,EAAYO,EAAQP,WAAcM,EAAME,MAAQD,EAAQC,OAASnB,EAAOI,CAE5EH,GAAKC,UAAUS,UAAUA,GAEzBM,EAAMG,iBACNH,EAAMI,mBAGR,QAASE,KACPL,GAAU,EACVV,EAAQC,IAAI,UAAU,GAGxB,QAASe,KACPzB,IACAS,EAAQC,IAAI,SAAS,GAGvB,QAASgB,KACPjB,EAAQC,IAAI,SAAS,GA7FvB,GAAIiB,GAAY,IAEZR,GAAU,EACVS,EAAoB,WAAaC,WAAYA,SAASC,cAAgB,GACnE,UACA,aAAc,iBAAkB,sBAEvC,IAA4C,mBAAjCtC,QAAOC,QAAQsC,eAA+B,CACvD,GAAIC,GAAUC,EAAE,UACbC,KACCC,SAAU,OACVC,WAAY,SACZ5B,OAAQ,GACR6B,MAAO,MAERC,KAAK,gDAERL,GAAE,QAAQM,OAAOP,EACjB,IAAIK,GAAQG,KAAKC,KAAK,IAAMT,EAAQU,KAAK,OAAOL,QAChDL,GAAQW,QAER,IAAIC,GAAQpD,OAAOqC,SAASgB,YAAY,EAEpCD,GAAME,WACRF,EAAME,WAAW,gCAAkCT,EAAQ,QAASO,EAAMG,SAASC,QAGnFJ,EAAMK,QAAQ,cAAe,kBAAoBZ,EAAQ,MAAO,IAGlE7C,OAAOC,QAAQsC,eAAiBM,EAkElC,GAAI5B,GAAUd,GACRuD,OAAQ,aACRtD,KAAMqC,EAAEkB,QAAO,GACbtC,IAAK,EACLL,OAAQ,EACR4C,QAAQ,EACRC,OAAO,EACPC,QAAQ,EACRC,OAAO,GACN3D,GAEH4D,OAAQxD,IAEVE,GACEuD,KAAMxB,EAAE,QACRyB,QAASzB,EAAExB,EAAQZ,IACnBS,SAAU2B,EAAExB,EAAQZ,IAAI6C,KAAK,wBAC7B3B,eAAgBkB,EAAExB,EAAQZ,IAAI6C,KAAK,+BACnCvC,UAAW8B,EAAExB,EAAQZ,IAAI8D,KAAK,eAGpClD,GAAQmD,GAAG,WAAY,WACrB1D,EAAKC,UAAU0D,IAAI,SAAUlD,GAC7BT,EAAKuD,KAAKI,IAAI,YAAatC,GAC3BrB,EAAKuD,KAAKI,IAAI,UAAWrC,GACzBtB,EAAKC,UAAU0D,IAAI,aAAcpC,GACjCvB,EAAKC,UAAU0D,IAAI,aAAcnC,GAEjCxB,EAAO,KACPO,EAAU,OAGZP,EAAKC,UAAU2D,OAAOnD,GAEtBT,EAAKI,SAASyD,WAAW,WACvBtD,EAAQC,IAAI,SAAS,KAGvBR,EAAKI,SAAS0D,WAAW,WACvBvD,EAAQC,IAAI,SAAS,KAGvBR,EAAKI,SAAS2D,MAAM,SAAS/C,GAC3B,GAAIA,EAAMgD,QAAUhE,EAAKI,SAAS,GAAlC,CAIA,GAAIO,GAAMC,IACNF,EAAYV,EAAKC,UAAUS,WAE/BV,GAAKC,UACFgE,OACAC,SACCxD,UAAWA,GAAaC,EAAMK,EAAMmD,SAAW1C,EAAYA,IAC1D,IAAK/B,EAAK0E,QAAU,YAG3BrC,EAAEsC,KAAK3C,EAAkB,SAAS4C,EAAGC,GACnCvE,EAAKI,SAASsD,GAAGa,EAAM,SAASvD,GAC9B,GAAIwD,GAAa,GAAIlF,QAAOmF,WAAWF,EAAMvD,EAAM0D,cAE/C/C,UAASgD,YACX3E,EAAKC,UAAU,GAAG2E,cAAcJ,GAGhCxE,EAAKC,UAAU,GAAG4E,UAAU,KAAOL,EAAWM,UAAWN,OAK/DxE,EAAKa,eAAekE,UAAUhE,GAC9Bf,EAAKuD,KAAKyB,UAAU3D,GACpBrB,EAAKuD,KAAK0B,QAAQ3D,GAElBtB,EAAKC,UAAU4D,WAAWtC,GAC1BvB,EAAKC,UAAU6D,WAAWtC,GAE1B1B,IAEAD","file":"scrolls/pl-scrolls.min.js","sourcesContent":["(function() {\n  'use strict';\n\n  window.Ractive.controller('pl-scrolls', function(component, data, el, config, done) {\n\n    var PAGE_SIZE = 268,\n\n        _inDrag = false,\n        _mousewheelBinds = ('onwheel' in document || document.documentMode >= 9) ?\n          ['wheel'] :\n          ['mousewheel', 'DomMouseScroll', 'MozMousePixelScroll'];\n\n    if (typeof window.Ractive.plScrollsWidth == 'undefined') {\n      var $tester = $('<div/>')\n        .css({\n          overflow: 'auto',\n          visibility: 'hidden',\n          height: 10,\n          width: 100\n        })\n        .html('<div style=\"height: 20px; width: 100%\"></div>');\n\n      $('body').append($tester);\n      var width = Math.ceil(100 - $tester.find('div').width());\n      $tester.remove();\n\n      var sheet = window.document.styleSheets[0];\n\n      if (sheet.insertRule) {\n        sheet.insertRule('.pl-scrolls { margin-right: -' + width + 'px; }', sheet.cssRules.length);\n      }\n      else {\n        sheet.addRule('.pl-scrolls', 'margin-right: -' + width + 'px;', -1);\n      }\n\n      window.Ractive.plScrollsWidth = width;\n    }\n\n    function _update() {\n      var area = _$el.container.prop('scrollHeight'),\n          max = _$el.vertical.outerHeight(),\n          height = max * 100 / area;\n\n      Scrolls.set('active', area > max);\n      Scrolls.set('height', height);\n      _scroll();\n    }\n\n    function _scroll() {\n      var area = _$el.container.prop('scrollHeight'),\n          scrollTop = _$el.container.scrollTop(),\n          top = scrollTop * 100 / area;\n\n      Scrolls.set('top', top);\n    }\n\n    function _topPX() {\n      return _$el.verticalTicker.offset().top - _$el.vertical.offset().top;\n    }\n\n    function _mousedown(event) {\n      _inDrag = {\n        scrollTop: _$el.container.scrollTop(),\n        pageY: event.pageY\n      };\n\n      Scrolls.set('inDrag', true);\n\n      event.preventDefault();\n      event.stopPropagation();\n    }\n\n    function _mousemove(event) {\n      if (!_inDrag) {\n        return;\n      }\n\n      var area = _$el.container.prop('scrollHeight'),\n          max = _$el.vertical.outerHeight(),\n          scrollTop = _inDrag.scrollTop + ((event.pageY - _inDrag.pageY) * area / max);\n\n      _$el.container.scrollTop(scrollTop);\n\n      event.preventDefault();\n      event.stopPropagation();\n    }\n\n    function _mouseup() {\n      _inDrag = false;\n      Scrolls.set('inDrag', false);\n    }\n\n    function _mouseenter() {\n      _update();\n      Scrolls.set('enter', true);\n    }\n\n    function _mouseleave() {\n      Scrolls.set('enter', false);\n    }\n\n    var Scrolls = component({\n          plName: 'pl-scrolls',\n          data: $.extend(true, {\n            top: 0,\n            height: 0,\n            active: false,\n            hover: false,\n            inDrag: false,\n            enter: false\n          }, data),\n\n          update: _update\n        }),\n        _$el = {\n          body: $('body'),\n          scrolls: $(Scrolls.el),\n          vertical: $(Scrolls.el).find('.pl-scrolls-vertical'),\n          verticalTicker: $(Scrolls.el).find('.pl-scrolls-vertical-ticker'),\n          container: $(Scrolls.el).next('.pl-scrolls')\n        };\n\n    Scrolls.on('teardown', function() {\n      _$el.container.off('scroll', _scroll);\n      _$el.body.off('mousemove', _mousemove);\n      _$el.body.off('mouseup', _mouseup);\n      _$el.container.off('mouseenter', _mouseenter);\n      _$el.container.off('mouseenter', _mouseleave);\n\n      _$el = null;\n      Scrolls = null;\n    });\n\n    _$el.container.scroll(_scroll);\n\n    _$el.vertical.mouseenter(function() {\n      Scrolls.set('hover', true);\n    });\n\n    _$el.vertical.mouseleave(function() {\n      Scrolls.set('hover', false);\n    });\n\n    _$el.vertical.click(function(event) {\n      if (event.target != _$el.vertical[0]) {\n        return;\n      }\n\n      var top = _topPX(),\n          scrollTop = _$el.container.scrollTop();\n\n      _$el.container\n        .stop()\n        .animate({\n          scrollTop: scrollTop + (top > event.offsetY ? -PAGE_SIZE : PAGE_SIZE)\n        }, 150, data.easing || 'swing');\n    });\n\n    $.each(_mousewheelBinds, function(i, bind) {\n      _$el.vertical.on(bind, function(event) {\n        var cloneEvent = new window.WheelEvent(bind, event.originalEvent);\n\n        if (document.createEvent) {\n          _$el.container[0].dispatchEvent(cloneEvent);\n        }\n        else {\n          _$el.container[0].fireEvent('on' + cloneEvent.eventType, cloneEvent);\n        }\n      });\n    });\n\n    _$el.verticalTicker.mousedown(_mousedown);\n    _$el.body.mousemove(_mousemove);\n    _$el.body.mouseup(_mouseup);\n\n    _$el.container.mouseenter(_mouseenter);\n    _$el.container.mouseleave(_mouseleave);\n\n    _update();\n\n    done();\n  });\n\n})();\n"],"sourceRoot":"/source/"}