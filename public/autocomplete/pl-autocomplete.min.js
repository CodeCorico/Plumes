!function(){"use strict";window.Ractive.controller("pl-autocomplete",function(t,e,i,n,o){function l(){var t=c.input.offset().top,e=c.input.outerWidth(),i=c.input.outerHeight();a.set("inEdition",a.get("focused")&&a.get("list")&&a.get("list").length),a.set("listWidth",e),a.set("listHeight",a.get("focused")?c.listContent.outerHeight():0),t+(i-2)+a.get("listHeight")>c.window.height()?(a.set("listFromBottom",!0),a.set("listTop",-a.get("listHeight")+2)):(a.set("listFromBottom",!1),a.set("listTop",i-2)),a.set("selectionWidth",e)}function s(t){var e=a.get("select");e&&e(t,c.input.val(),a),c.input.blur()}function u(t){var e=a.get("change");e&&e(t,c.input.val(),a)}var a=t({plName:"pl-autocomplete",data:$.extend(!0,{focused:!1,inEdition:!1,listfocused:-1,listTop:0,listWidth:0,listHeight:0,selection:""},e),partials:$.extend(!0,{templateDefault:["<div"," class=\"pl-autocomplete-list-item {{listfocused == @index ? 'focused' : ''}}\"",' on-mousedown="selectListItem"',' on-mouseenter="enterListItem"',">","{{{display}}}","</div>"].join("")},n.partials),refresh:function(){l()},clear:function(){c.input.val(""),u(event)},focus:function(){c.input.focus()}}),c={window:$(window),input:$(a.el).find(".pl-autocomplete-input"),selection:$(a.el).find(".pl-autocomplete-selection"),list:$(a.el).find(".pl-autocomplete-list"),listContent:$(a.el).find(".pl-autocomplete-list-content")};a.partials.template=a.partials.template||a.partials.templateDefault,a.on("enterListItem",function(t){a.set("listfocused",parseInt(t.keypath.substring(t.keypath.lastIndexOf(".")+1),10))}),a.on("selectListItem",function(t){t.original.stopPropagation(),t.original.preventDefault(),c.input.val(t.context.value),u(t)}),a.on("inputFocus",function(t){a.set("focused",!0),l();var e=a.get("focus");e&&e(t,c.input.val(),a)}),a.on("inputBlur",function(t){a.set("focused",!1),l();var e=a.get("blur");e&&e(t,c.input.val(),a)}),a.on("inputKeydown",function(t){var e=a.get("keydown");e&&e(t,a)}),a.on("inputKeyup",function(t){var e=a.get("keyup");if(!e||e(t,a)!==!1){var i=t.original.charCode?t.original.charCode:t.original.keyCode,n=a.get("selection"),o=a.get("list"),l=a.get("listfocused");return 39==i&&n?(c.input.val(n),void u(t)):(38==i||40==i)&&o&&o.length?(l+=38==i?-1:1,l=-2==l?o.length-1:l,l=l==o.length?-1:l,void a.set("listfocused",l)):13==i?void(o&&o.length&&-1!==l?o&&o.length&&o[l]&&(c.input.val(o[l].value),a.set("listfocused",-1),u(t)):s(t)):void u(t)}}),a.observe("list",function(t){a.set("selection",t&&t.length&&t[0].value||""),a.set("listfocused",-1),setTimeout(l)}),o()})}();
//# sourceMappingURL=pl-autocomplete.min.js.map
