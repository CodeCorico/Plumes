{"version":3,"sources":["layout/layout.js"],"names":["window","Ractive","controller","component","data","el","config","done","_refreshDirContent","$bar","dir","expended","length","$dirContent","parents","layout","set","width","fire","_$el","get","height","content","outerHeight","waiting","setTimeout","uses","Title","$","each","i","partials","parseInt","titleAreaHeight","loaded","use","page","parentRequire","find","on","event","name","node","leftContentExpended","rightContentExpended","args","selectApp","fireFunc","callback","addApp","app","indexOrPosition","addTitle","removeApp","removeTitle","onloaded","remove","beforeRequire","beforerequire","l","require","then","findChild","cls","filter","value","indexOf","push","title","toLowerCase","replace","fireSelected"],"mappings":"CAAA,WACE,YAEAA,QAAOC,QAAQC,WAAW,SAAU,SAASC,EAAWC,EAAMC,EAAIC,EAAQC,GAmCxE,QAASC,GAAmBC,EAAMC,EAAKC,GACrC,GAAKF,GAASA,EAAKG,OAAnB,CAIA,GAAIC,GAAcJ,EAAKK,QAAQ,WAAaJ,EAAM,aAElDK,GAAOC,IAAIN,EAAM,kBAAmBC,GACpCI,EAAOC,IAAIN,EAAM,mBAAoBC,EAAWE,EAAYI,QAAUR,EAAKQ,SAC3EF,EAAOC,IAAIN,EAAM,aAAcC,EAAW,GAAKE,EAAYI,QAAUR,EAAKQ,SAE1EF,EAAOG,KAAK,iBACVD,MAAOE,EAAKnB,OAAOiB,QAAUF,EAAOK,IAAI,wBAA0BL,EAAOK,IAAI,yBAC7EC,OAAQF,EAAKG,QAAQC,cACrBC,QAAS,MAGPb,EACFI,EAAOC,IAAIN,EAAM,yBAAyB,GAG1Ce,WAAW,WACTV,EAAOC,IAAIN,EAAM,yBAAyB,IACzC,MAzDP,GAAIgB,IAAQ,WAAY,WAAY,aAAc,UAAW,WACzDC,EAAQ,IAEZC,GAAEC,MAAM,OAAQ,SAAU,SAASC,EAAGpB,GACpCN,EAAKM,EAAM,eAAiBJ,GAAUA,EAAOyB,UAAYzB,EAAOyB,SAASrB,EAAM,YAC/EN,EAAKM,EAAM,mBAAqBN,EAAKM,EAAM,sBAA2D,SAAnCN,EAAKM,EAAM,sBAAkC,GAAQ,EACxHN,EAAKM,EAAM,gBAAkBN,EAAKM,EAAM,mBAAqB,KAC7DN,EAAKM,EAAM,gBAAkBN,EAAKM,EAAM,kBAAoBsB,SAAS5B,EAAKM,EAAM,kBAAmB,IAAM,EACzGN,EAAKM,EAAM,cAAgB,EAC3BN,EAAKM,EAAM,0BAA2B,EACtCN,EAAKM,EAAM,oBAAsBN,EAAKM,EAAM,eAAiBN,EAAKM,EAAM,gBAAkB,KAG5FN,EAAK6B,gBAAkB,GAEvB7B,EAAK8B,QAAS,CAEd,KAAK,GAAIJ,GAAI,EAAGA,EAAIJ,EAAKd,OAAQkB,IAAK,CACpC,GAAIK,GAAMT,EAAKI,EAEf1B,GAAK+B,GAA2B,mBAAb/B,GAAK+B,IAAsB,EAAO/B,EAAK+B,GAC1D/B,EAAK+B,GAAoB,QAAb/B,EAAK+B,IAAiB,EAAO/B,EAAK+B,GAC9C/B,EAAK+B,GAAoB,SAAb/B,EAAK+B,IAAkB,EAAQ/B,EAAK+B,GAGlD,GAAIpB,GAASZ,GACPC,KAAMA,IAERgC,EAAOrB,EAAOsB,cACdlB,GACEnB,OAAQ4B,EAAE5B,QACVsB,QAASM,EAAEb,EAAOV,IAAIiC,KAAK,mBA8BjCvB,GAAOwB,GAAG,+BAAgC,SAASC,GACjD,GAAI9B,GAAoB,iBAAd8B,EAAMC,KAA0B,OAAS,QAC/C9B,GAAYI,EAAOK,IAAIV,EAAM,kBAEjCF,GAAmBoB,EAAEY,EAAME,MAAOhC,EAAKC,KAGzCH,EAAmBoB,EAAEb,EAAOV,IAAIiC,KAAK,8BAA+B,OAAQlC,EAAKuC,qBACjFnC,EAAmBoB,EAAEb,EAAOV,IAAIiC,KAAK,+BAAgC,QAASlC,EAAKwC,sBAEnF7B,EAAOwB,GAAG,YAAa,SAASM,GAC9B9B,EAAOC,IAAI,kBAAmB6B,EAAKxB,OAAS,MAG9CN,EAAOwB,GAAG,aAAc,SAASM,GAC/B9B,EAAOC,IAAI,kBAAmB6B,EAAKxB,OAAS,MAG9CN,EAAO+B,UAAY,SAASL,EAAMM,EAAUC,GACrCrB,GAILA,EAAMmB,UAAUL,EAAMM,EAAUC,IAGlCjC,EAAOkC,OAAS,SAASC,EAAKC,GACvBxB,GAILA,EAAMyB,SAASF,EAAKC,IAGtBpC,EAAOsC,UAAY,SAASZ,GACrBd,GAILA,EAAM2B,YAAYb,IAGpBhB,WAAW,WACLrB,EAAKmD,UACPnD,EAAKmD,SAASxC,GAGhBA,EAAOC,IAAI,UAAU,GAErBS,WAAW,WACTV,EAAOC,IAAI,eAAe,GAE1BS,WAAW,WACTG,EAAE,gBAAgB4B,QAElB,IAAIC,GAAgBrD,EAAKsD,eAAiB,SAASC,EAAGX,GACpDA,IAGFS,GAAc1C,EAAQ,WACpBA,EAAOC,IAAI,gBAAiB,MAC5BZ,EAAKsD,cAAgB,KAErB3C,EAAOC,IAAI,SAAS,GAEpBD,EAAO6C,UAAUC,KAAK,WACpB,GAAIlC,GAAQZ,EAAO+C,UAAU,OAAQ,iBAEjCnC,KACFA,EAAMY,GAAG,OAAQ,SAASM,GACxB9B,EAAOG,KAAK,YAAa2B,KAG3BlB,EAAMY,GAAG,QAAS,SAASM,GACzB9B,EAAOG,KAAK,aAAc2B,KAG5BlB,EAAMY,GAAG,gBAAiB,SAASM,GACjC,GAAIkB,GAAM3B,EAAKhB,IAAI,UACnB2C,GAAMA,EAAIC,OAAO,SAASC,GACxB,MAAiC,KAA1BA,EAAMC,QAAQ,UAGvBH,EAAII,KAAK,OAAStB,EAAKuB,MAAM3B,KAC1B4B,cACAC,QAAQ,cAAe,KAG1BlC,EAAKpB,IAAI,MAAO+C,KAGlBpC,EAAM4C,gBAGRhE,SAGH,MAEF","file":"layout/layout.min.js","sourcesContent":["(function() {\n  'use strict';\n\n  window.Ractive.controller('layout', function(component, data, el, config, done) {\n    var uses = ['usebrand', 'usetitle', 'useprofile', 'usehelp', 'usemask'],\n        Title = null;\n\n    $.each(['left', 'right'], function(i, dir) {\n      data[dir + 'ContentUsed'] = config && config.partials && config.partials[dir + '-content'];\n      data[dir + 'ContentExpended'] = data[dir + '-content-expended'] && data[dir + '-content-expended'] == 'false' ? false : true;\n      data[dir + 'ContentTitle'] = data[dir + '-content-title'] || null;\n      data[dir + 'ContentWidth'] = data[dir + '-content-width'] ? parseInt(data[dir + '-content-width'], 10) : 0;\n      data[dir + 'ContentPos'] = 0;\n      data[dir + 'ContentCollapsedAfter'] = false;\n      data[dir + 'ContentAreaWidth'] = data[dir + 'ContentUsed'] ? data[dir + 'ContentWidth'] : 30;\n    });\n\n    data.titleAreaHeight = 90;\n\n    data.loaded = false;\n\n    for (var i = 0; i < uses.length; i++) {\n      var use = uses[i];\n\n      data[use] = typeof data[use] == 'undefined' ? true : data[use];\n      data[use] = data[use] == 'true' ? true : data[use];\n      data[use] = data[use] == 'false' ? false : data[use];\n    }\n\n    var layout = component({\n          data: data\n        }),\n        page = layout.parentRequire,\n        _$el = {\n          window: $(window),\n          content: $(layout.el).find('.layout-content')\n        };\n\n    function _refreshDirContent($bar, dir, expended) {\n      if (!$bar || !$bar.length) {\n        return;\n      }\n\n      var $dirContent = $bar.parents('.layout-' + dir + '-container');\n\n      layout.set(dir + 'ContentExpended', expended);\n      layout.set(dir + 'ContentAreaWidth', expended ? $dirContent.width() : $bar.width());\n      layout.set(dir + 'ContentPos', expended ? 0 : -$dirContent.width() + $bar.width());\n\n      layout.fire('contentResize', {\n        width: _$el.window.width() - layout.get('leftContentAreaWidth') - layout.get('rightContentAreaWidth'),\n        height: _$el.content.outerHeight(),\n        waiting: 550\n      });\n\n      if (expended) {\n        layout.set(dir + 'ContentCollapsedAfter', false);\n      }\n      else {\n        setTimeout(function() {\n          layout.set(dir + 'ContentCollapsedAfter', true);\n        }, 550);\n      }\n    }\n\n    layout.on('toggleLeftBar toggleRightBar', function(event) {\n      var dir = event.name == 'toggleLeftBar' ? 'left' : 'right',\n          expended = !layout.get(dir + 'ContentExpended');\n\n      _refreshDirContent($(event.node), dir, expended);\n    });\n\n    _refreshDirContent($(layout.el).find('.layout-left-bar-container'), 'left', data.leftContentExpended);\n    _refreshDirContent($(layout.el).find('.layout-right-bar-container'), 'right', data.rightContentExpended);\n\n    layout.on('titleOpen', function(args) {\n      layout.set('titleAreaHeight', args.height + 50);\n    });\n\n    layout.on('titleClose', function(args) {\n      layout.set('titleAreaHeight', args.height + 50);\n    });\n\n    layout.selectApp = function(name, fireFunc, callback) {\n      if (!Title) {\n        return;\n      }\n\n      Title.selectApp(name, fireFunc, callback);\n    };\n\n    layout.addApp = function(app, indexOrPosition) {\n      if (!Title) {\n        return;\n      }\n\n      Title.addTitle(app, indexOrPosition);\n    };\n\n    layout.removeApp = function(name) {\n      if (!Title) {\n        return;\n      }\n\n      Title.removeTitle(name);\n    };\n\n    setTimeout(function() {\n      if (data.onloaded) {\n        data.onloaded(layout);\n      }\n\n      layout.set('loaded', true);\n\n      setTimeout(function() {\n        layout.set('beforeStart', true);\n\n        setTimeout(function() {\n          $('.layout-mask').remove();\n\n          var beforeRequire = data.beforerequire || function(l, callback) {\n            callback();\n          };\n\n          beforeRequire(layout, function() {\n            layout.set('beforerequire', null);\n            data.beforerequire = null;\n\n            layout.set('start', true);\n\n            layout.require().then(function() {\n              var Title = layout.findChild('name', 'dropdown-title');\n\n              if (Title) {\n                Title.on('open', function(args) {\n                  layout.fire('titleOpen', args);\n                });\n\n                Title.on('close', function(args) {\n                  layout.fire('titleClose', args);\n                });\n\n                Title.on('titleSelected', function(args) {\n                  var cls = page.get('cls') || [];\n                  cls = cls.filter(function(value) {\n                    return value.indexOf('app-') !== 0;\n                  });\n\n                  cls.push('app-' + args.title.name\n                    .toLowerCase()\n                    .replace(/[^a-z0-9]/gi, '')\n                  );\n\n                  page.set('cls', cls);\n                });\n\n                Title.fireSelected();\n              }\n\n              done();\n            });\n          });\n        }, 550);\n\n      }, 1500);\n    });\n  });\n\n})();\n"],"sourceRoot":"/source/"}