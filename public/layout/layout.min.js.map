{"version":3,"sources":["layout/layout.js"],"names":["window","Ractive","controller","component","data","el","config","done","_refreshDirContent","dir","expended","_freezeSet","$dirContent","_$el","layout","find","$bar","set","width","fire","get","height","content","outerHeight","waiting","setTimeout","_uses","_dirs","Title","$","each","i","partials","titleAreaHeight","loaded","length","use","page","parentRequire","observe","newValue","parseInt","on","event","name","leftContentExpended","rightContentExpended","args","selectApp","fireFunc","callback","addApp","app","indexOrPosition","addTitle","removeApp","removeTitle","onloaded","remove","beforeRequire","beforerequire","l","require","then","findChild","cls","filter","value","indexOf","push","title","toLowerCase","replace","fireSelected"],"mappings":"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","file":"layout/layout.min.js","sourcesContent":["(function() {\n  'use strict';\n\n  window.Ractive.controller('layout', function(component, data, el, config, done) {\n    var _uses = ['usebrand', 'usetitle', 'useprofile', 'usehelp', 'usemask'],\n        _dirs = ['left', 'right'],\n        _freezeSet = false,\n        Title = null;\n\n    $.each(_dirs, function(i, dir) {\n      data[dir + 'ContentUsed'] = config && config.partials && config.partials[dir + '-content'];\n      data[dir + 'ContentPos'] = 0;\n      data[dir + 'ContentCollapsedAfter'] = false;\n      data[dir + 'ContentAreaWidth'] = data[dir + 'ContentUsed'] ? data[dir + 'ContentWidth'] : 30;\n    });\n\n    data.titleAreaHeight = 90;\n\n    data.loaded = false;\n\n    for (var i = 0; i < _uses.length; i++) {\n      var use = _uses[i];\n\n      data[use] = typeof data[use] == 'undefined' ? true : data[use];\n      data[use] = data[use] == 'true' ? true : data[use];\n      data[use] = data[use] == 'false' ? false : data[use];\n    }\n\n    var layout = component({\n          data: data\n        }),\n        page = layout.parentRequire,\n        _$el = {\n          window: $(window),\n          layout: $(layout.el),\n          content: $(layout.el).find('.layout-content')\n        };\n\n    function _refreshDirContent(dir, expended) {\n      _freezeSet = true;\n\n      var $dirContent = _$el.layout.find('.layout-' + dir + '-container'),\n          $bar = $dirContent.find('.layout-' + dir + '-bar-container');\n\n      layout.set(dir + 'ContentExpended', expended);\n      layout.set(dir + '-content-expended', expended);\n      layout.set(dir + 'ContentAreaWidth', expended ? $dirContent.width() : $bar.width());\n      layout.set(dir + 'ContentPos', expended ? 0 : -$dirContent.width() + $bar.width());\n\n      layout.fire('contentResize', {\n        width: _$el.window.width() - layout.get('leftContentAreaWidth') - layout.get('rightContentAreaWidth'),\n        height: _$el.content.outerHeight(),\n        waiting: 550\n      });\n\n      if (expended) {\n        layout.set(dir + 'ContentCollapsedAfter', false);\n      }\n      else {\n        setTimeout(function() {\n          layout.set(dir + 'ContentCollapsedAfter', true);\n        }, 550);\n      }\n\n      _freezeSet = false;\n    }\n\n    $.each(_dirs, function(i, dir) {\n      layout.observe(dir + '-content-expended', function(newValue) {\n        if (_freezeSet) {\n          return;\n        }\n\n        var expended = newValue === false || (newValue && newValue == 'false') ? false : true;\n\n        _refreshDirContent(dir, expended);\n      });\n\n      layout.observe(dir + '-content-title', function(newValue) {\n        if (_freezeSet) {\n          return;\n        }\n\n        layout.set(dir + 'ContentTitle', newValue || null);\n      });\n\n      layout.observe(dir + '-content-width', function(newValue) {\n        if (_freezeSet) {\n          return;\n        }\n\n        layout.set(dir + 'ContentWidth', newValue ? parseInt(newValue, 10) : 0);\n\n        _refreshDirContent(dir, !!layout.get(dir + 'ContentExpended'));\n      });\n    });\n\n    layout.on('toggleLeftBar toggleRightBar', function(event) {\n      var dir = event.name == 'toggleLeftBar' ? 'left' : 'right',\n          expended = !layout.get(dir + 'ContentExpended');\n\n      _refreshDirContent(dir, expended);\n    });\n\n    _refreshDirContent('left', data.leftContentExpended);\n    _refreshDirContent('right', data.rightContentExpended);\n\n    layout.on('titleOpen', function(args) {\n      layout.set('titleAreaHeight', args.height + 50);\n    });\n\n    layout.on('titleClose', function(args) {\n      layout.set('titleAreaHeight', args.height + 50);\n    });\n\n    layout.selectApp = function(name, fireFunc, callback) {\n      if (!Title) {\n        return;\n      }\n\n      Title.selectApp(name, fireFunc, callback);\n    };\n\n    layout.addApp = function(app, indexOrPosition) {\n      if (!Title) {\n        return;\n      }\n\n      Title.addTitle(app, indexOrPosition);\n    };\n\n    layout.removeApp = function(name) {\n      if (!Title) {\n        return;\n      }\n\n      Title.removeTitle(name);\n    };\n\n    setTimeout(function() {\n      if (data.onloaded) {\n        data.onloaded(layout);\n      }\n\n      layout.set('loaded', true);\n\n      setTimeout(function() {\n        layout.set('beforeStart', true);\n\n        setTimeout(function() {\n          $('.layout-mask').remove();\n\n          var beforeRequire = data.beforerequire || function(l, callback) {\n            callback();\n          };\n\n          beforeRequire(layout, function() {\n            layout.set('beforerequire', null);\n            data.beforerequire = null;\n\n            layout.set('start', true);\n\n            layout.require().then(function() {\n              var Title = layout.findChild('name', 'dropdown-title');\n\n              if (Title) {\n                Title.on('open', function(args) {\n                  layout.fire('titleOpen', args);\n                });\n\n                Title.on('close', function(args) {\n                  layout.fire('titleClose', args);\n                });\n\n                Title.on('titleSelected', function(args) {\n                  var cls = page.get('cls') || [];\n                  cls = cls.filter(function(value) {\n                    return value.indexOf('app-') !== 0;\n                  });\n\n                  cls.push('app-' + args.title.name\n                    .toLowerCase()\n                    .replace(/[^a-z0-9]/gi, '')\n                  );\n\n                  page.set('cls', cls);\n                });\n\n                Title.fireSelected();\n              }\n\n              done();\n            });\n          });\n        }, 550);\n\n      }, 1500);\n    });\n  });\n\n})();\n"],"sourceRoot":"/source/"}