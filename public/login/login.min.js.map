{"version":3,"sources":["login/login.js"],"names":["window","Ractive","controller","component","data","el","config","done","_refresh","messageHeight","_$el","message","outerHeight","Login","set","height","forgotTexts","position","top","_focusName","login","find","focus","_modal","type","clearUsername","clearUserpassword","callback","setTimeout","texts","username","userpassword","_error","_success","_submit","get","fire","password","confirmPassword","code","_close","shouldDestroy","teardown","_resize","storyboard","$","useforgot","each","name","value","substr","length","avatar","inForgot","usernamePlaceholder","userpasswordPlaceholder","userpasswordconfirm","forgotlink","forgottext","forgotcodetext","forgotpasswordtext","forgotpasswordhelp","extend","show","keypress","event","which","preventDefault","stopPropagation","lastObserveUsernameDate","Date","observe","getTime","oldValue","on","off","text","ScreenMessage","findChild","args","inForgotCode","inForgotPassword","resize","require","then","textQuestion","lastLineToTitle","displayTextTime","offset"],"mappings":"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","file":"login/login.min.js","sourcesContent":["(function() {\n  'use strict';\n\n  window.Ractive.controller('login', function(component, data, el, config, done) {\n\n    var _$el = {\n          window: $(window),\n          login: null\n        };\n\n    data.useforgot = typeof data.useforgot == 'undefined' ? true : data.useforgot;\n    data.useforgot = data.useforgot == 'true' ? true : data.useforgot;\n    data.useforgot = data.useforgot == 'false' ? false : data.useforgot;\n\n    data.texts = {};\n\n    $.each(data, function(name, value) {\n      if (name.substr(0, 5) == 'text-') {\n        name = name.substr(5, name.length - 5);\n        data.texts[name] = value;\n      }\n    });\n\n    data.avatar = !data.avatar ? 'null' : data.avatar;\n    data.inForgot = false;\n\n    data.texts.username = typeof data.texts.username == 'undefined' ? 'Name' : data.texts.username;\n    data.usernamePlaceholder = data.texts.username;\n    data.texts.code = typeof data.texts.code == 'undefined' ? 'Code' : data.texts.code;\n    data.texts.userpassword = typeof data.texts.userpassword == 'undefined' ? 'Password' : data.texts.userpassword;\n    data.userpasswordPlaceholder = data.texts.userpassword;\n    data.texts.userpasswordconfirm = typeof data.texts.userpasswordconfirm == 'undefined' ? 'Confirm password' : data.texts.userpasswordconfirm;\n    data.texts.forgotlink = typeof data.texts.forgotlink == 'undefined' ? 'I forgot my password' : data.texts.forgotlink;\n    data.texts.login = typeof data.texts.login == 'undefined' ? 'Back to login' : data.texts.login;\n    data.texts.forgottext = typeof data.texts.forgottext == 'undefined' ?\n      'Submit your email and press <span class=\"key\">ENTER</span> to receive a validation code in your mailbox.' :\n      data.texts.forgottext;\n    data.texts.forgotcodetext = typeof data.texts.forgotcodetext == 'undefined' ?\n      'Use your <strong>validation code</strong> and press <span class=\"key\">ENTER</span> to get the possibility to change your password.' :\n      data.texts.forgotcodetext;\n    data.texts.forgotpasswordtext = typeof data.texts.forgotpasswordtext == 'undefined' ?\n      'Enter your new password twice (to confirm) and press <span class=\"key\">ENTER</span> to change your password.' :\n      data.texts.forgotpasswordtext;\n    data.texts.forgotpasswordhelp = typeof data.texts.forgotpasswordhelp == 'undefined' ?\n      'When creating your password, remember the following:' +\n      '<ol>' +\n        '<li>It must not contain your name.</li>' +\n        '<li>It must contain one or more digits.</li>' +\n        '<li>It is recommended to mix lowercase and uppercase characters.</li>' +\n        '<li>It should be long over 7 characters.</li>' +\n      '</ol>' :\n      data.texts.forgotpasswordhelp;\n\n    function _refresh() {\n      var messageHeight = _$el.message.outerHeight(true);\n\n      Login.set('height', _$el.window.height() - (100 + messageHeight + 30));\n      Login.set('helpTop', _$el.forgotTexts.position().top);\n    }\n\n    var Login = component({\n      data: $.extend(true, {\n        show: false,\n        top: 0\n      }, data)\n    });\n\n    _$el.login = $(Login.el);\n    _$el.forgotTexts = _$el.login.find('.login-forgot-texts');\n\n    function _focusName() {\n      _$el.login.find('.name').focus();\n    }\n\n    function _modal(message, type, clearUsername, clearUserpassword, callback) {\n      Login.set('inModal', true);\n      Login.set('message', message);\n      Login.set('messageType', type);\n      Login.set('storyboardMessage', 'sb-message-1');\n\n      setTimeout(function() {\n        if (clearUsername) {\n          Login.set('username', '');\n        }\n        if (clearUserpassword) {\n          Login.set('userpassword', '');\n        }\n\n        if (type == 'success') {\n          Login.set('usernamePlaceholder', data.texts.username);\n          Login.set('userpasswordPlaceholder', data.texts.userpassword);\n        }\n\n        Login.set('storyboardMessage', 'sb-message-2');\n        setTimeout(function() {\n          Login.set('storyboardMessage', 'sb-message-3');\n          setTimeout(function() {\n            Login.set('storyboardMessage', 'sb-message-4');\n            setTimeout(function() {\n              Login.set('storyboardError', null);\n              Login.set('inModal', false);\n\n              if (callback) {\n                callback();\n              }\n            }, 350);\n          }, 250);\n        }, 3000);\n      }, 250);\n    }\n\n    function _error(message, clearUsername, clearUserpassword, callback) {\n      _modal(message, 'error', clearUsername, clearUserpassword, callback);\n    }\n\n    function _success(message, callback) {\n      _modal(message, 'success', true, true, callback);\n    }\n\n    function _submit() {\n      if (Login.get('inForgotPassword')) {\n        Login.fire('forgotPassword', {\n          password: Login.get('username'),\n          confirmPassword: Login.get('userpassword')\n        });\n      }\n      else if (Login.get('inForgotCode')) {\n        Login.fire('forgotCode', {\n          code: Login.get('username')\n        });\n      }\n      else if (Login.get('inForgot')) {\n        Login.fire('forgot', {\n          username: Login.get('username')\n        });\n      }\n      else {\n        Login.fire('login', {\n          username: Login.get('username'),\n          userpassword: Login.get('userpassword')\n        });\n      }\n    }\n\n    _$el.login.find('.login-form-content .input').keypress(function(event) {\n      // enter\n      if (event.which == 13) {\n        _submit();\n\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    });\n\n    var lastObserveUsernameDate = new Date();\n\n    Login.observe('username', function() {\n      if (Login.get('inForgotCode') || Login.get('inForgotPassword')) {\n        return;\n      }\n\n      lastObserveUsernameDate = new Date();\n\n      var username = Login.get('username');\n\n      setTimeout(function() {\n        if (new Date().getTime() - lastObserveUsernameDate.getTime() >= 1000) {\n          Login.fire('username', {\n            username: username\n          });\n        }\n      }, 1000);\n    });\n\n    Login.observe('avatar', function(value, oldValue) {\n      if (oldValue == value) {\n        return;\n      }\n      if (!value) {\n        value = 'null';\n        Login.set('avatar', value);\n        if (oldValue == 'null') {\n          return;\n        }\n      }\n\n      Login.set('oldAvatar', oldValue);\n      setTimeout(function() {\n        Login.set('oldAvatar', null);\n      }, 650);\n    });\n\n    Login.on('teardown', function() {\n      Login = null;\n      _$el.window.off('resize', _resize);\n    });\n\n    function _close() {\n      Login.fire('closed');\n\n      if (Login && !Login.shouldDestroy) {\n        Login.teardown();\n      }\n    }\n\n    Login.on('logged', function(text) {\n      var ScreenMessage = Login.findChild('name', 'screen-message');\n      ScreenMessage.fire('closeTitle');\n\n      Login.set('storyboard', 'sb-hide-1');\n\n      Login.set('top', 0);\n      Login.set('height', _$el.window.height());\n\n      setTimeout(function() {\n        Login.set('storyboard', 'sb-hide-2');\n\n        setTimeout(function() {\n          Login.set('storyboard', 'sb-hide-3');\n\n          setTimeout(function() {\n\n            if (text) {\n              ScreenMessage.fire('play', {\n                message: text,\n                done: function() {\n                  _close();\n                }\n              });\n            }\n            else {\n              _close();\n            }\n          }, 150);\n        }, 400);\n      }, 350);\n    });\n\n    Login.on('close', _close);\n\n    Login.on('error', function(args) {\n      args = $.extend(true, {\n        message: 'You have an error in your credentials.',\n        clearUsername: false,\n        clearUserpassword: true\n      }, args || {});\n\n      _error(args.message, args.clearUsername, args.clearUserpassword, _focusName);\n    });\n\n    Login.on('displayForgot', function() {\n      _refresh();\n      Login.set('inForgot', true);\n      Login.fire('enterForgot');\n\n      setTimeout(_focusName);\n    });\n\n    Login.on('openHelp', function() {\n      Login.set('inHelp', true);\n      setTimeout(_focusName);\n    });\n\n    Login.on('displayLogin', function() {\n      var inForgot = Login.get('inForgot'),\n          inForgotCode = Login.get('inForgotCode'),\n          inForgotPassword = Login.get('inForgotPassword');\n\n      if (inForgotCode || inForgotPassword) {\n        Login.set('username', '');\n        Login.set('userpassword', '');\n      }\n\n      Login.set('inHelp', false);\n      Login.set('inForgot', false);\n      Login.set('inForgotCode', false);\n      Login.set('inForgotPassword', false);\n      Login.set('usernamePlaceholder', data.texts.username);\n      Login.set('userpasswordPlaceholder', data.texts.userpassword);\n\n      if (inForgotCode) {\n        Login.fire('exitForgotCode');\n      }\n\n      if (inForgotPassword) {\n        Login.fire('exitForgotPassword');\n      }\n\n      if (inForgot) {\n        Login.fire('exitForgot');\n      }\n\n      setTimeout(_focusName);\n    });\n\n    Login.on('forgotSuccess', function() {\n      Login.set('inForgotCode', true);\n      Login.set('username', '');\n      Login.set('usernamePlaceholder', data.texts.code);\n\n      Login.fire('enterForgotCode');\n\n      setTimeout(_focusName);\n    });\n\n    Login.on('forgotError', function(args) {\n      args = $.extend(true, {\n        message: 'This email address doesn\\'t exist.',\n        clearUsername: false,\n        clearUserpassword: false\n      }, args || {});\n\n      _error(args.message, args.clearUsername, args.clearUserpassword, _focusName);\n    });\n\n    Login.on('forgotCodeSuccess', function() {\n      Login.set('inForgotCode', false);\n      Login.set('inForgotPassword', true);\n      Login.set('username', '');\n      Login.set('usernamePlaceholder', data.texts.userpassword);\n      Login.set('userpassword', '');\n      Login.set('userpasswordPlaceholder', data.texts.userpasswordconfirm);\n\n      Login.fire('enterForgotPassword');\n\n      setTimeout(_focusName);\n    });\n\n    Login.on('forgotCodeError', function(args) {\n      args = $.extend(true, {\n        message: 'Code invalid.',\n        clearUsername: true,\n        clearUserpassword: false\n      }, args || {});\n\n      _error(args.message, args.clearUsername, args.clearUserpassword, _focusName);\n    });\n\n    Login.on('forgotPasswordSuccess', function(args) {\n      args = $.extend(true, {\n        message: 'New password registered.'\n      }, args || {});\n\n      _success(args.message, function() {\n        Login.fire('displayLogin');\n      });\n    });\n\n    Login.on('forgotPasswordError', function(args) {\n      args = $.extend(true, {\n        message: 'Passwords are invalid.',\n        clearUsername: true,\n        clearUserpassword: true\n      }, args || {});\n\n      _error(args.message, args.clearUsername, args.clearUserpassword, _focusName);\n    });\n\n    function _resize() {\n      if (!Login) {\n        return;\n      }\n\n      var storyboard = Login.get('storyboard');\n\n      if (storyboard == 'sb-show-2' || storyboard == 'sb-show-3' || storyboard == 'sb-show-4') {\n        _refresh();\n      }\n    }\n\n    _$el.window.resize(_resize);\n\n    Login.require().then(function() {\n      var ScreenMessage = Login.findChild('name', 'screen-message'),\n          textQuestion = Login.get('texts.question');\n\n      textQuestion = !textQuestion && textQuestion !== '' ? 'Who are you?' : textQuestion;\n\n      ScreenMessage.fire('play', {\n        message: textQuestion,\n        lastLineToTitle: true,\n        displayTextTime: 350,\n        done: function() {\n          _$el.message = $(ScreenMessage.el).find('.screen-message-message');\n\n          var messageHeight = _$el.message.outerHeight(true);\n\n          Login.set('top', _$el.message.offset().top + messageHeight - 1);\n          Login.set('height', 1);\n          Login.set('storyboard', 'sb-show-1');\n\n          setTimeout(function() {\n            Login.set('storyboard', 'sb-show-2');\n            Login.set('top', 100 + messageHeight);\n            _refresh();\n\n            setTimeout(function() {\n              Login.set('storyboard', 'sb-show-3');\n\n              setTimeout(function() {\n                _$el.login.find(!data.username ? '.name' : '.password').focus();\n                Login.set('storyboard', 'sb-show-4');\n              }, 450);\n\n            }, 450);\n          }, 650);\n        }\n      });\n\n      done();\n    });\n\n  });\n\n})();\n"],"sourceRoot":"/source/"}