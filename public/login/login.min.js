!function(){"use strict";window.Ractive.controller("login",function(e,s,t,o,r){function n(){var e=i.message.outerHeight(!0);u.set("height",i.window.height()-(100+e+30))}function a(){u.fire("closed"),u.teardown()}var i={window:$(window)};s.texts={},$.each(s,function(e,t){"text-"==e.substr(0,5)&&(e=e.substr(5,e.length-5),s.texts[e]=t)}),s.avatar="undefined"==typeof s.avatar?"/public/login/avatar.png":s.avatar,s.texts.username="undefined"==typeof s.texts.username?"Name":s.texts.username,s.texts.userpassword="undefined"==typeof s.texts.userpassword?"Password":s.texts.userpassword;var u=e({data:$.extend(!0,{show:!1,top:0},s)});u.on("passwordFocus",function(){u.fire("usernameChanged",u.get("username"))}),u.observe("avatar",function(e,s){s!=e&&(u.set("oldAvatar",s),setTimeout(function(){u.set("oldAvatar",null)},650))}),u.on("logged",function(e){var s=u.childrenRequire[0];s.fire("closeTitle"),u.set("storyboard","sb-hide-1"),u.set("top",0),u.set("height",i.window.height()),setTimeout(function(){u.set("storyboard","sb-hide-2"),setTimeout(function(){u.set("storyboard","sb-hide-3"),setTimeout(function(){e?s.fire("play",{message:e,done:function(){a()}}):a()},150)},400)},350)}),u.on("close",function(){u.fire("closed"),u.teardown()}),u.on("submit",function(e){u.fire("login",{username:u.get("username"),userpassword:u.get("userpassword")}),e.original.preventDefault()}),u.on("error",function(e){e=$.extend(!0,{message:"You have an error in your credentials.",clearUsername:!1,clearUserpassword:!0},e||{}),u.set("error",e.message),u.set("storyboardError","sb-error-1"),setTimeout(function(){e.clearUsername&&u.set("username",""),e.clearUserpassword&&u.set("userpassword",""),u.set("storyboardError","sb-error-2"),setTimeout(function(){u.set("storyboardError","sb-error-3"),setTimeout(function(){u.set("storyboardError","sb-error-4"),setTimeout(function(){u.set("storyboardError",null)},350)},250)},3e3)},250)}),i.window.resize(function(){if(u){var e=u.get("storyboard");("sb-show-2"==e||"sb-show-3"==e)&&n()}}),u.require().then(function(){var e=u.childrenRequire[0],t=u.get("texts.question");t=t||""===t?t:"Who are you?",e.fire("play",{message:t,lastLineToTitle:!0,displayTextTime:350,done:function(){i.message=$(e.el).find(".screen-message-message");var t=i.message.outerHeight(!0);u.set("top",i.message.offset().top+t-1),u.set("height",1),u.set("storyboard","sb-show-1"),setTimeout(function(){u.set("storyboard","sb-show-2"),u.set("top",100+t),n(),setTimeout(function(){u.set("storyboard","sb-show-3"),setTimeout(function(){$(u.el).find(s.username?".password":".name").focus()},450)},450)},650)}}),r()})})}();
//# sourceMappingURL=../login/login.min.js.map