!function(){"use strict";window.Ractive.controller("login",function(e,s,t,o,r){function n(){var e=u.message.outerHeight(!0);d.set("height",u.window.height()-(100+e+30))}function a(){d.fire("closed"),d&&!d.shouldDestroy&&d.teardown()}function i(){if(d){var e=d.get("storyboard");("sb-show-2"==e||"sb-show-3"==e)&&n()}}var u={window:$(window)};s.texts={},$.each(s,function(e,t){"text-"==e.substr(0,5)&&(e=e.substr(5,e.length-5),s.texts[e]=t)}),s.avatar=s.avatar?s.avatar:"null",s.texts.username="undefined"==typeof s.texts.username?"Name":s.texts.username,s.texts.userpassword="undefined"==typeof s.texts.userpassword?"Password":s.texts.userpassword;var d=e({data:$.extend(!0,{show:!1,top:0},s)});d.on("passwordFocus",function(){d.fire("usernameChanged",d.get("username"))}),d.observe("avatar",function(e,s){s!=e&&(e||(e="null",d.set("avatar",e),"null"!=s))&&(d.set("oldAvatar",s),setTimeout(function(){d.set("oldAvatar",null)},650))}),d.on("teardown",function(){d=null,u.window.off("resize",i)}),d.on("logged",function(e){var s=d.childrenRequire[0];s.fire("closeTitle"),d.set("storyboard","sb-hide-1"),d.set("top",0),d.set("height",u.window.height()),setTimeout(function(){d.set("storyboard","sb-hide-2"),setTimeout(function(){d.set("storyboard","sb-hide-3"),setTimeout(function(){e?s.fire("play",{message:e,done:function(){a()}}):a()},150)},400)},350)}),d.on("close",a),d.on("submit",function(e){d.fire("login",{username:d.get("username"),userpassword:d.get("userpassword")}),e.original.preventDefault()}),d.on("error",function(e){e=$.extend(!0,{message:"You have an error in your credentials.",clearUsername:!1,clearUserpassword:!0},e||{}),d.set("error",e.message),d.set("storyboardError","sb-error-1"),setTimeout(function(){e.clearUsername&&d.set("username",""),e.clearUserpassword&&d.set("userpassword",""),d.set("storyboardError","sb-error-2"),setTimeout(function(){d.set("storyboardError","sb-error-3"),setTimeout(function(){d.set("storyboardError","sb-error-4"),setTimeout(function(){d.set("storyboardError",null)},350)},250)},3e3)},250)}),u.window.resize(i),d.require().then(function(){var e=d.childrenRequire[0],t=d.get("texts.question");t=t||""===t?t:"Who are you?",e.fire("play",{message:t,lastLineToTitle:!0,displayTextTime:350,done:function(){u.message=$(e.el).find(".screen-message-message");var t=u.message.outerHeight(!0);d.set("top",u.message.offset().top+t-1),d.set("height",1),d.set("storyboard","sb-show-1"),setTimeout(function(){d.set("storyboard","sb-show-2"),d.set("top",100+t),n(),setTimeout(function(){d.set("storyboard","sb-show-3"),setTimeout(function(){$(d.el).find(s.username?".password":".name").focus()},450)},450)},650)}}),r()})})}();
//# sourceMappingURL=../login/login.min.js.map