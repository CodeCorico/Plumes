{"version":3,"sources":["login/pl-login.js"],"names":["window","Ractive","controller","component","data","el","config","done","_refresh","messageHeight","_$el","message","outerHeight","Login","set","height","forgotTexts","position","top","_focusName","login","find","focus","_modal","type","clearUsername","clearUserpassword","callback","setTimeout","texts","username","userpassword","_error","_success","_submit","get","fire","password","confirmPassword","code","_close","shouldDestroy","teardown","_resize","storyboard","useforgot","$","each","name","value","substr","length","avatar","inForgot","usernamePlaceholder","userpasswordPlaceholder","userpasswordconfirm","forgotlink","forgottext","forgotcodetext","forgotpasswordtext","forgotpasswordhelp","plName","extend","show","keypress","event","which","preventDefault","stopPropagation","lastObserveUsernameDate","Date","observe","getTime","oldValue","on","off","text","ScreenMessage","findChild","args","inForgotCode","inForgotPassword","resize","require","then","textQuestion","lastLineToTitle","displayTextTime","offset"],"mappings":"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","file":"login/pl-login.min.js","sourcesContent":["(function() {\n  'use strict';\n\n  window.Ractive.controller('pl-login', function(component, data, el, config, done) {\n\n    data.useforgot = typeof data.useforgot == 'undefined' ? true : data.useforgot;\n    data.useforgot = data.useforgot == 'true' ? true : data.useforgot;\n    data.useforgot = data.useforgot == 'false' ? false : data.useforgot;\n\n    data.texts = {};\n\n    $.each(data, function(name, value) {\n      if (name.substr(0, 5) == 'text-') {\n        name = name.substr(5, name.length - 5);\n        data.texts[name] = value;\n      }\n    });\n\n    data.avatar = !data.avatar ? 'null' : data.avatar;\n    data.inForgot = false;\n\n    data.texts.username = typeof data.texts.username == 'undefined' ? 'Name' : data.texts.username;\n    data.usernamePlaceholder = data.texts.username;\n    data.texts.code = typeof data.texts.code == 'undefined' ? 'Code' : data.texts.code;\n    data.texts.userpassword = typeof data.texts.userpassword == 'undefined' ? 'Password' : data.texts.userpassword;\n    data.userpasswordPlaceholder = data.texts.userpassword;\n    data.texts.userpasswordconfirm = typeof data.texts.userpasswordconfirm == 'undefined' ? 'Confirm password' : data.texts.userpasswordconfirm;\n    data.texts.forgotlink = typeof data.texts.forgotlink == 'undefined' ? 'I forgot my password' : data.texts.forgotlink;\n    data.texts.login = typeof data.texts.login == 'undefined' ? 'Back to login' : data.texts.login;\n    data.texts.forgottext = typeof data.texts.forgottext == 'undefined' ?\n      'Submit your email and press <span class=\"key\">ENTER</span> to receive a validation code in your mailbox.' :\n      data.texts.forgottext;\n    data.texts.forgotcodetext = typeof data.texts.forgotcodetext == 'undefined' ?\n      'Use your <strong>validation code</strong> and press <span class=\"key\">ENTER</span> to get the possibility to change your password.' :\n      data.texts.forgotcodetext;\n    data.texts.forgotpasswordtext = typeof data.texts.forgotpasswordtext == 'undefined' ?\n      'Enter your new password twice (to confirm) and press <span class=\"key\">ENTER</span> to change your password.' :\n      data.texts.forgotpasswordtext;\n    data.texts.forgotpasswordhelp = typeof data.texts.forgotpasswordhelp == 'undefined' ?\n      'When creating your password, remember the following:' +\n      '<ol>' +\n        '<li>It must not contain your name.</li>' +\n        '<li>It must contain one or more digits.</li>' +\n        '<li>It is recommended to mix lowercase and uppercase characters.</li>' +\n        '<li>It should be long over 7 characters.</li>' +\n      '</ol>' :\n      data.texts.forgotpasswordhelp;\n\n    var Login = component({\n          plName: 'pl-login',\n          data: $.extend(true, {\n            show: false,\n            top: 0\n          }, data)\n        }),\n        _$el = {\n          window: $(window),\n          login: $(Login.el),\n          forgotTexts: $(Login.el).find('.pl-login-forgot-texts')\n        };\n\n    function _refresh() {\n      var messageHeight = _$el.message.outerHeight(true);\n\n      Login.set('height', _$el.window.height() - (40 + messageHeight + 30));\n      Login.set('helpTop', _$el.forgotTexts.position().top);\n    }\n\n    function _focusName() {\n      _$el.login.find('.name').focus();\n    }\n\n    function _modal(message, type, clearUsername, clearUserpassword, callback) {\n      Login.set('inModal', true);\n      Login.set('message', message);\n      Login.set('messageType', type);\n      Login.set('storyboardMessage', 'sb-message-1');\n\n      setTimeout(function() {\n        if (clearUsername) {\n          Login.set('username', '');\n        }\n        if (clearUserpassword) {\n          Login.set('userpassword', '');\n        }\n\n        if (type == 'success') {\n          Login.set('usernamePlaceholder', data.texts.username);\n          Login.set('userpasswordPlaceholder', data.texts.userpassword);\n        }\n\n        Login.set('storyboardMessage', 'sb-message-2');\n        setTimeout(function() {\n          Login.set('storyboardMessage', 'sb-message-3');\n          setTimeout(function() {\n            Login.set('storyboardMessage', 'sb-message-4');\n            setTimeout(function() {\n              Login.set('storyboardError', null);\n              Login.set('inModal', false);\n\n              if (callback) {\n                callback();\n              }\n            }, 350);\n          }, 250);\n        }, 3000);\n      }, 250);\n    }\n\n    function _error(message, clearUsername, clearUserpassword, callback) {\n      _modal(message, 'error', clearUsername, clearUserpassword, callback);\n    }\n\n    function _success(message, callback) {\n      _modal(message, 'success', true, true, callback);\n    }\n\n    function _submit() {\n      if (Login.get('inForgotPassword')) {\n        Login.fire('forgotPassword', {\n          password: Login.get('username'),\n          confirmPassword: Login.get('userpassword')\n        });\n      }\n      else if (Login.get('inForgotCode')) {\n        Login.fire('forgotCode', {\n          code: Login.get('username')\n        });\n      }\n      else if (Login.get('inForgot')) {\n        Login.fire('forgot', {\n          username: Login.get('username')\n        });\n      }\n      else {\n        Login.fire('login', {\n          username: Login.get('username'),\n          userpassword: Login.get('userpassword')\n        });\n      }\n    }\n\n    _$el.login.find('.pl-login-form-content .input').keypress(function(event) {\n      // enter\n      if (event.which == 13) {\n        _submit();\n\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    });\n\n    var lastObserveUsernameDate = new Date();\n\n    Login.observe('username', function() {\n      if (Login.get('inForgotCode') || Login.get('inForgotPassword')) {\n        return;\n      }\n\n      lastObserveUsernameDate = new Date();\n\n      var username = Login.get('username');\n\n      setTimeout(function() {\n        if (new Date().getTime() - lastObserveUsernameDate.getTime() >= 1000) {\n          Login.fire('username', {\n            username: username\n          });\n        }\n      }, 1000);\n    });\n\n    Login.observe('avatar', function(value, oldValue) {\n      if (oldValue == value) {\n        return;\n      }\n      if (!value) {\n        value = 'null';\n        Login.set('avatar', value);\n        if (oldValue == 'null') {\n          return;\n        }\n      }\n\n      Login.set('oldAvatar', oldValue);\n      setTimeout(function() {\n        Login.set('oldAvatar', null);\n      }, 650);\n    });\n\n    Login.on('teardown', function() {\n      Login = null;\n      _$el.window.off('resize', _resize);\n    });\n\n    function _close() {\n      Login.fire('closed');\n\n      if (Login && !Login.shouldDestroy) {\n        Login.teardown();\n      }\n    }\n\n    Login.on('logged', function(text) {\n      var ScreenMessage = Login.findChild('name', 'pl-screen-message');\n      ScreenMessage.fire('closeTitle');\n\n      Login.set('storyboard', 'sb-hide-1');\n\n      setTimeout(function() {\n        Login.set('storyboard', 'sb-hide-2');\n\n        setTimeout(function() {\n          Login.set('storyboard', 'sb-hide-3');\n\n          setTimeout(function() {\n\n            if (text) {\n              ScreenMessage.fire('play', {\n                message: text,\n                done: function() {\n                  _close();\n                }\n              });\n            }\n            else {\n              _close();\n            }\n          }, 150);\n        }, 400);\n      }, 350);\n    });\n\n    Login.on('close', _close);\n\n    Login.on('error', function(args) {\n      args = $.extend(true, {\n        message: 'You have an error in your credentials.',\n        clearUsername: false,\n        clearUserpassword: true\n      }, args || {});\n\n      _error(args.message, args.clearUsername, args.clearUserpassword, _focusName);\n    });\n\n    Login.on('displayForgot', function() {\n      _refresh();\n      Login.set('inForgot', true);\n      Login.fire('enterForgot');\n\n      setTimeout(_focusName);\n    });\n\n    Login.on('openHelp', function() {\n      Login.set('inHelp', true);\n      setTimeout(_focusName);\n    });\n\n    Login.on('displayLogin', function() {\n      var inForgot = Login.get('inForgot'),\n          inForgotCode = Login.get('inForgotCode'),\n          inForgotPassword = Login.get('inForgotPassword');\n\n      if (inForgotCode || inForgotPassword) {\n        Login.set('username', '');\n        Login.set('userpassword', '');\n      }\n\n      Login.set('inHelp', false);\n      Login.set('inForgot', false);\n      Login.set('inForgotCode', false);\n      Login.set('inForgotPassword', false);\n      Login.set('usernamePlaceholder', data.texts.username);\n      Login.set('userpasswordPlaceholder', data.texts.userpassword);\n\n      if (inForgotCode) {\n        Login.fire('exitForgotCode');\n      }\n\n      if (inForgotPassword) {\n        Login.fire('exitForgotPassword');\n      }\n\n      if (inForgot) {\n        Login.fire('exitForgot');\n      }\n\n      setTimeout(_focusName);\n    });\n\n    Login.on('forgotSuccess', function() {\n      Login.set('inForgotCode', true);\n      Login.set('username', '');\n      Login.set('usernamePlaceholder', data.texts.code);\n\n      Login.fire('enterForgotCode');\n\n      setTimeout(_focusName);\n    });\n\n    Login.on('forgotError', function(args) {\n      args = $.extend(true, {\n        message: 'This email address doesn\\'t exist.',\n        clearUsername: false,\n        clearUserpassword: false\n      }, args || {});\n\n      _error(args.message, args.clearUsername, args.clearUserpassword, _focusName);\n    });\n\n    Login.on('forgotCodeSuccess', function() {\n      Login.set('inForgotCode', false);\n      Login.set('inForgotPassword', true);\n      Login.set('username', '');\n      Login.set('usernamePlaceholder', data.texts.userpassword);\n      Login.set('userpassword', '');\n      Login.set('userpasswordPlaceholder', data.texts.userpasswordconfirm);\n\n      Login.fire('enterForgotPassword');\n\n      setTimeout(_focusName);\n    });\n\n    Login.on('forgotCodeError', function(args) {\n      args = $.extend(true, {\n        message: 'Code invalid.',\n        clearUsername: true,\n        clearUserpassword: false\n      }, args || {});\n\n      _error(args.message, args.clearUsername, args.clearUserpassword, _focusName);\n    });\n\n    Login.on('forgotPasswordSuccess', function(args) {\n      args = $.extend(true, {\n        message: 'New password registered.'\n      }, args || {});\n\n      _success(args.message, function() {\n        Login.fire('displayLogin');\n      });\n    });\n\n    Login.on('forgotPasswordError', function(args) {\n      args = $.extend(true, {\n        message: 'Passwords are invalid.',\n        clearUsername: true,\n        clearUserpassword: true\n      }, args || {});\n\n      _error(args.message, args.clearUsername, args.clearUserpassword, _focusName);\n    });\n\n    function _resize() {\n      if (!Login) {\n        return;\n      }\n\n      var storyboard = Login.get('storyboard');\n\n      if (storyboard == 'sb-show-2' || storyboard == 'sb-show-3' || storyboard == 'sb-show-4') {\n        _refresh();\n      }\n    }\n\n    _$el.window.resize(_resize);\n\n    Login.require().then(function() {\n      var ScreenMessage = Login.findChild('name', 'pl-screen-message'),\n          textQuestion = Login.get('texts.question');\n\n      textQuestion = !textQuestion && textQuestion !== '' ? 'Who are you?' : textQuestion;\n\n      ScreenMessage.fire('play', {\n        message: textQuestion,\n        lastLineToTitle: true,\n        displayTextTime: 350,\n        done: function() {\n          _$el.message = $(ScreenMessage.el).find('.pl-screen-messages-message');\n\n          var messageHeight = _$el.message.outerHeight(true);\n\n          Login.set('top', _$el.message.offset().top + messageHeight - 1);\n          Login.set('height', 1);\n          Login.set('storyboard', 'sb-show-1');\n\n          setTimeout(function() {\n            Login.set('storyboard', 'sb-show-2');\n            Login.set('top', 40 + messageHeight);\n            _refresh();\n\n            setTimeout(function() {\n              Login.set('storyboard', 'sb-show-3');\n\n              setTimeout(function() {\n                _$el.login.find(!data.username ? '.name' : '.password').focus();\n                Login.set('storyboard', 'sb-show-4');\n              }, 450);\n\n            }, 450);\n          }, 650);\n        }\n      });\n\n      done();\n    });\n\n  });\n\n})();\n"],"sourceRoot":"/source/"}