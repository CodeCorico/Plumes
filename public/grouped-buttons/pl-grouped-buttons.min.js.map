{"version":3,"sources":["grouped-buttons/pl-grouped-buttons.js"],"names":["window","Ractive","controller","component","data","el","config","done","_registerIndicatorEvents","on","args","index","parseInt","$","attr","GroupedButtons","once","set","get","MODES","COMPACT","width","_updatePositions","callback","require","then","buttons","positions","compactPositionsTop","compactPositions","compactOpened","hidden","windowWidth","totalWidth","compactTotalWidth","compactTop","compactHeight","i","length","button","findChild","isReady","type","ready","setTimeout","fire","DEFAULT","plName","extend","mode","orientation","compactButtonPosition","action","event","hide","show","compactMode","defaultMode","opened","observe"],"mappings":"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","file":"grouped-buttons/pl-grouped-buttons.min.js","sourcesContent":["(function() {\n  'use strict';\n\n  window.Ractive.controller('pl-grouped-buttons', function(component, data, el, config, done) {\n\n    var MODES = {\n      DEFAULT: 'default',\n      COMPACT: 'compact'\n    };\n\n    var GroupedButtons = component({\n      plName: 'pl-grouped-buttons',\n      data: $.extend(true, {\n        mode: MODES.DEFAULT,\n        hidden: true,\n        orientation: 'left',\n        buttons: [],\n        positions: [],\n        compactPositionsTop: [],\n        compactPositions: [],\n        compactButtonPosition: -100,\n        compactOpened: false,\n        compactHeight: 0,\n\n        action: function(event, component) {\n          if (!component) {\n            return;\n          }\n\n          var index = parseInt($(component.el).attr('data-index'), 10),\n              button = GroupedButtons.get('buttons[' + index + ']'),\n              component = GroupedButtons.findChild('data-index', index);\n\n          GroupedButtons.fire('beforeAction', {\n            event: event,\n            button: button,\n            component: component\n          });\n\n          if (GroupedButtons.get('mode') == MODES.COMPACT && GroupedButtons.get('compactOpened')) {\n            GroupedButtons.fire('compactAction');\n          }\n\n          if (button && button.action) {\n            button.action(event, component);\n          }\n\n          GroupedButtons.fire('action', {\n            event: event,\n            button: button,\n            component: component\n          });\n        }\n      }, data),\n\n      hide: function() {\n        if (GroupedButtons.get('hidden')) {\n          return;\n        }\n\n        GroupedButtons.set('hidden', true);\n\n        GroupedButtons.set('compactButtonPosition', -100);\n\n        _updatePositions();\n      },\n\n      show: function() {\n        if (!GroupedButtons.get('hidden')) {\n          return;\n        }\n\n        GroupedButtons.set('hidden', false);\n\n        if (GroupedButtons.get('mode') == MODES.COMPACT) {\n          GroupedButtons.set('compactButtonPosition', -15);\n        }\n\n        _updatePositions();\n      },\n\n      compactMode: function() {\n        if (GroupedButtons.get('mode') == MODES.COMPACT) {\n          return;\n        }\n\n        GroupedButtons.set('mode', MODES.COMPACT);\n\n        GroupedButtons.set('compactButtonPosition', -15);\n      },\n\n      defaultMode: function() {\n        if (GroupedButtons.get('mode') == MODES.DEFAULT) {\n          return;\n        }\n\n        if (GroupedButtons.get('compactOpened')) {\n          GroupedButtons.fire('compactAction');\n        }\n\n        GroupedButtons.set('mode', MODES.DEFAULT);\n\n        GroupedButtons.set('compactButtonPosition', -100);\n      }\n    });\n\n    GroupedButtons.on('compactAction', function() {\n      var compactOpened = !GroupedButtons.get('compactOpened');\n\n      GroupedButtons.fire('beforeCompact', {\n        button: GroupedButtons,\n        opened: compactOpened\n      });\n\n      GroupedButtons.set('compactOpened', compactOpened);\n\n      _updatePositions(function(args) {\n        if (compactOpened) {\n          GroupedButtons.set('compactHeight', args.compactHeight);\n        }\n\n        GroupedButtons.fire('compact', {\n          button: GroupedButtons,\n          opened: compactOpened\n        });\n      });\n    });\n\n    function _registerIndicatorEvents(component) {\n      component.on('showNotification', function(args) {\n        var index = parseInt($(component.el).attr('data-index'), 10);\n\n        GroupedButtons.once('positionsChanged', function() {\n          GroupedButtons.set('compactPositionsTop[' + index + ']', 0);\n          GroupedButtons.set('compactPositions[' + index + ']', 0);\n\n          if (GroupedButtons.get('mode') == MODES.COMPACT) {\n            GroupedButtons.set('compactButtonPosition', -100);\n          }\n        });\n\n        GroupedButtons.set('buttons[' + index + '].width', args.width + 10);\n      });\n\n      component.on('hideNotification', function() {\n        var index = parseInt($(component.el).attr('data-index'), 10);\n\n        GroupedButtons.set('buttons[' + index + '].width', 55);\n\n        if (GroupedButtons.get('mode') == MODES.COMPACT) {\n          GroupedButtons.set('compactButtonPosition', -15);\n        }\n      });\n    }\n\n    function _updatePositions(callback) {\n      GroupedButtons.require().then(function() {\n        var buttons = GroupedButtons.get('buttons'),\n            positions = GroupedButtons.get('positions'),\n            compactPositionsTop = GroupedButtons.get('compactPositionsTop'),\n            compactPositions = GroupedButtons.get('compactPositions'),\n            compactOpened = GroupedButtons.get('compactOpened'),\n            hidden = GroupedButtons.get('hidden'),\n            windowWidth = $(window).width(),\n            totalWidth = 0,\n            compactTotalWidth = 20,\n            compactTop = 0,\n            compactHeight = 60;\n\n        for (var i = buttons.length - 1; i >= 0; i--) {\n          var button = buttons[i],\n              component = GroupedButtons.findChild('data-index', i);\n\n          if (hidden) {\n            positions[i] = -100;\n            compactPositions[i] = -100;\n          }\n          else {\n            positions[i] = totalWidth;\n\n            if (compactOpened) {\n              compactPositions[i] = compactTotalWidth;\n            }\n            else {\n              compactPositions[i] = -100;\n            }\n          }\n\n          compactPositionsTop[i] = compactTop;\n\n          if (!component) {\n            return;\n          }\n\n          if (!button.isReady) {\n            button.isReady = true;\n            button.width = button.type == 'indicator' ? 55 : 50;\n\n            if (button.type == 'indicator') {\n              _registerIndicatorEvents(component, button, i);\n            }\n\n            if (button.ready) {\n              button.ready(component);\n            }\n          }\n\n          totalWidth += button.width || 0;\n          compactTotalWidth += button.width || 0;\n\n          if (!hidden && compactTotalWidth > windowWidth) {\n            compactHeight += 50;\n            compactTop += 50;\n            compactTotalWidth = 20;\n            compactPositionsTop[i] = compactTop;\n\n            if (compactOpened) {\n              compactPositions[i] = compactTotalWidth;\n            }\n          }\n        }\n\n        GroupedButtons.set('positions', positions);\n        GroupedButtons.set('compactPositionsTop', compactPositionsTop);\n        GroupedButtons.set('compactPositions', compactPositions);\n\n        setTimeout(function() {\n          GroupedButtons.fire('positionsChanged');\n        });\n\n        if (callback) {\n          callback({\n            compactHeight: compactHeight\n          });\n        }\n      });\n    }\n\n    GroupedButtons.observe('buttons', function() {\n      _updatePositions();\n    });\n\n    _updatePositions();\n\n    done();\n  });\n\n})();\n"],"sourceRoot":"/source/"}