{"version":3,"sources":["grouped-buttons/pl-grouped-buttons.js"],"names":["window","Ractive","controller","component","data","el","config","done","_registerIndicatorEvents","buttonEl","button","i","on","args","GroupedButtons","once","set","get","MODES","COMPACT","width","_updatePositions","callback","require","then","buttons","positions","compactPositionsTop","compactPositions","compactOpened","hidden","windowWidth","$","totalWidth","compactTotalWidth","compactTop","compactHeight","length","findChild","isReady","type","ready","setTimeout","fire","DEFAULT","plName","extend","mode","orientation","compactButtonPosition","action","event","index","parseInt","attr","hide","show","compactMode","defaultMode","opened","observe"],"mappings":"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","file":"grouped-buttons/pl-grouped-buttons.min.js","sourcesContent":["(function() {\n  'use strict';\n\n  window.Ractive.controller('pl-grouped-buttons', function(component, data, el, config, done) {\n\n    var MODES = {\n      DEFAULT: 'default',\n      COMPACT: 'compact'\n    };\n\n    var GroupedButtons = component({\n      plName: 'pl-grouped-buttons',\n      data: $.extend(true, {\n        mode: MODES.DEFAULT,\n        hidden: true,\n        orientation: 'left',\n        buttons: [],\n        positions: [],\n        compactPositionsTop: [],\n        compactPositions: [],\n        compactButtonPosition: -100,\n        compactOpened: false,\n        compactHeight: 0,\n\n        action: function(event, component) {\n          if (!component) {\n            return;\n          }\n\n          var index = parseInt($(component.el).attr('data-index'), 10),\n              button = GroupedButtons.get('buttons[' + index + ']'),\n              component = GroupedButtons.findChild('data-index', index);\n\n          GroupedButtons.fire('beforeAction', {\n            event: event,\n            button: button,\n            component: component\n          });\n\n          if (GroupedButtons.get('mode') == MODES.COMPACT && GroupedButtons.get('compactOpened')) {\n            GroupedButtons.fire('compactAction');\n          }\n\n          if (button && button.action) {\n            button.action(event, component);\n          }\n\n          GroupedButtons.fire('action', {\n            event: event,\n            button: button,\n            component: component\n          });\n        }\n      }, data),\n\n      hide: function() {\n        if (GroupedButtons.get('hidden')) {\n          return;\n        }\n\n        GroupedButtons.set('hidden', true);\n\n        GroupedButtons.set('compactButtonPosition', -100);\n\n        _updatePositions();\n      },\n\n      show: function() {\n        if (!GroupedButtons.get('hidden')) {\n          return;\n        }\n\n        GroupedButtons.set('hidden', false);\n\n        if (GroupedButtons.get('mode') == MODES.COMPACT) {\n          GroupedButtons.set('compactButtonPosition', -15);\n        }\n\n        _updatePositions();\n      },\n\n      compactMode: function() {\n        if (GroupedButtons.get('mode') == MODES.COMPACT) {\n          return;\n        }\n\n        GroupedButtons.set('mode', MODES.COMPACT);\n\n        GroupedButtons.set('compactButtonPosition', -15);\n      },\n\n      defaultMode: function() {\n        if (GroupedButtons.get('mode') == MODES.DEFAULT) {\n          return;\n        }\n\n        if (GroupedButtons.get('compactOpened')) {\n          GroupedButtons.fire('compactAction');\n        }\n\n        GroupedButtons.set('mode', MODES.DEFAULT);\n\n        GroupedButtons.set('compactButtonPosition', -100);\n      }\n    });\n\n    GroupedButtons.on('compactAction', function() {\n      var compactOpened = !GroupedButtons.get('compactOpened');\n\n      GroupedButtons.fire('beforeCompact', {\n        button: GroupedButtons,\n        opened: compactOpened\n      });\n\n      GroupedButtons.set('compactOpened', compactOpened);\n\n      _updatePositions(function(args) {\n        if (compactOpened) {\n          GroupedButtons.set('compactHeight', args.compactHeight);\n        }\n\n        GroupedButtons.fire('compact', {\n          button: GroupedButtons,\n          opened: compactOpened\n        });\n      });\n    });\n\n    function _registerIndicatorEvents(buttonEl, button, i) {\n      buttonEl.on('showNotification', function(args) {\n\n        GroupedButtons.once('positionsChanged', function() {\n          GroupedButtons.set('compactPositionsTop[' + i + ']', 0);\n          GroupedButtons.set('compactPositions[' + i + ']', 0);\n\n          if (GroupedButtons.get('mode') == MODES.COMPACT) {\n            GroupedButtons.set('compactButtonPosition', -100);\n          }\n        });\n\n        GroupedButtons.set('buttons[' + i + '].width', args.width + 10);\n      });\n\n      buttonEl.on('hideNotification', function() {\n        GroupedButtons.set('buttons[' + i + '].width', 55);\n\n        if (GroupedButtons.get('mode') == MODES.COMPACT) {\n          GroupedButtons.set('compactButtonPosition', -15);\n        }\n      });\n    }\n\n    function _updatePositions(callback) {\n      GroupedButtons.require().then(function() {\n        var buttons = GroupedButtons.get('buttons'),\n            positions = GroupedButtons.get('positions'),\n            compactPositionsTop = GroupedButtons.get('compactPositionsTop'),\n            compactPositions = GroupedButtons.get('compactPositions'),\n            compactOpened = GroupedButtons.get('compactOpened'),\n            hidden = GroupedButtons.get('hidden'),\n            windowWidth = $(window).width(),\n            totalWidth = 0,\n            compactTotalWidth = 20,\n            compactTop = 0,\n            compactHeight = 60;\n\n        for (var i = buttons.length - 1; i >= 0; i--) {\n          var button = buttons[i],\n              buttonEl = GroupedButtons.findChild('data-index', i);\n\n          if (hidden) {\n            positions[i] = -100;\n            compactPositions[i] = -100;\n          }\n          else {\n            positions[i] = totalWidth;\n\n            if (compactOpened) {\n              compactPositions[i] = compactTotalWidth;\n            }\n            else {\n              compactPositions[i] = -100;\n            }\n          }\n\n          compactPositionsTop[i] = compactTop;\n\n          if (!buttonEl) {\n            return;\n          }\n\n          if (!button.isReady) {\n            button.isReady = true;\n            button.width = button.type == 'indicator' ? 55 : 50;\n\n            if (button.type == 'indicator') {\n              _registerIndicatorEvents(buttonEl, button, i);\n            }\n\n            if (button.ready) {\n              button.ready(buttonEl);\n            }\n          }\n\n          totalWidth += button.width || 0;\n          compactTotalWidth += button.width || 0;\n\n          if (!hidden && compactTotalWidth > windowWidth) {\n            compactHeight += 50;\n            compactTop += 50;\n            compactTotalWidth = 20;\n            compactPositionsTop[i] = compactTop;\n\n            if (compactOpened) {\n              compactPositions[i] = compactTotalWidth;\n            }\n          }\n        }\n\n        GroupedButtons.set('positions', positions);\n        GroupedButtons.set('compactPositionsTop', compactPositionsTop);\n        GroupedButtons.set('compactPositions', compactPositions);\n\n        setTimeout(function() {\n          GroupedButtons.fire('positionsChanged');\n        });\n\n        if (callback) {\n          callback({\n            compactHeight: compactHeight\n          });\n        }\n      });\n    }\n\n    GroupedButtons.observe('buttons', function() {\n      _updatePositions();\n    });\n\n    _updatePositions();\n\n    done();\n  });\n\n})();\n"],"sourceRoot":"/source/"}