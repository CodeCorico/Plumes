{"version":3,"sources":["layouts/pl-layout-platform.js"],"names":["window","Ractive","controller","component","data","el","config","done","_resize","openOrientation","screenWidth","_$el","width","screen","LayoutPlatform","get","contentMedia","VIEWS","DESKTOP","set","_groupedButtons","left","defaultMode","right","_contexts","close","TABLET","MOBILE","compactMode","templateWidth","contentTemplate","outerWidth","_updateTitlePosition","fire","setTimeout","_closeContext","orientation","panel","findChild","_registerGroupedButtonsEvents","on","_beforeButtonsAction","_beforeButtonsCompact","show","_registerContextEvents","opened","args","$group","removeClass","_displayContextGroup","context","$context","find","addClass","title","attr","open","button","group","beforeGroup","callback","forEach","$","length","hasClass","isOpened","closeContent","beforeContext","titleText","_updateTitleArea","height","titleWidth","Title","plName","extend","loaded","titleShowed","titleLeft","titleLeftOffset","titleBgLeftOffset","titleBgWidth","titleBgHeight","buttonsleft","buttonsright","contextlefttitle","contextrighttitle","contextleftusetitle","contextrightusetitle","leftContextWidth","rightContextWidth","leftContextOpened","rightContextOpened","contentLeft","contentRight","crossleftcontext","crossrightcontext","leftGroupedButtons","rightGroupedButtons","leftContext","rightContext","Page","parentRequire","platform","content","bindUses","observe","value","resize","off","selectApp","name","fireFunc","addApp","app","indexOrPosition","addTitle","removeApp","removeTitle","onloaded","beforeRequire","beforerequire","l","require","then","cls","filter","indexOf","push","toLowerCase","replace","fireSelected","remove"],"mappings":"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","file":"layouts/pl-layout-platform.min.js","sourcesContent":["(function() {\n  'use strict';\n\n  window.Ractive.controller('pl-layout-platform', function(component, data, el, config, done) {\n    var VIEWS = {\n          DESKTOP: 1000,\n          TABLET: 450,\n          MOBILE: 0\n        },\n\n        Title = null,\n        _groupedButtons = {\n          left: null,\n          right: null\n        },\n        _contexts = {\n          left: null,\n          right: null\n        };\n\n    function _resize(openOrientation) {\n      var screenWidth = _$el.window.width(),\n          screen = LayoutPlatform.get('screen'),\n          contentMedia = LayoutPlatform.get('contentMedia');\n\n      if (screenWidth >= VIEWS.DESKTOP) {\n        LayoutPlatform.set('leftContextWidth', LayoutPlatform.get('leftContextOpened') ? '25%' : 0);\n        LayoutPlatform.set('rightContextWidth', LayoutPlatform.get('rightContextOpened') ? '25%' : 0);\n\n        LayoutPlatform.set('contentLeft', LayoutPlatform.get('leftContextOpened') ? '25%' : 0);\n        LayoutPlatform.set('contentRight', LayoutPlatform.get('rightContextOpened') ? '25%' : 0);\n\n        if (_groupedButtons.left) {\n          _groupedButtons.left.defaultMode();\n        }\n        if (_groupedButtons.right) {\n          _groupedButtons.right.defaultMode();\n        }\n\n        LayoutPlatform.set('screen', 'screen-desktop');\n      }\n      else {\n        if (openOrientation == 'left' && LayoutPlatform.get('rightContextOpened')) {\n          _contexts.right.close();\n          LayoutPlatform.set('rightContextOpened', false);\n        }\n        else if (openOrientation == 'right' && LayoutPlatform.get('leftContextOpened')) {\n          _contexts.left.close();\n          LayoutPlatform.set('leftContextOpened', false);\n        }\n        else if (LayoutPlatform.get('leftContextOpened') && LayoutPlatform.get('rightContextOpened')) {\n          _contexts.right.close();\n          LayoutPlatform.set('rightContextOpened', false);\n        }\n\n        if (screenWidth >= VIEWS.TABLET) {\n          LayoutPlatform.set('leftContextWidth', LayoutPlatform.get('leftContextOpened') ? '75%' : 0);\n          LayoutPlatform.set('rightContextWidth', LayoutPlatform.get('rightContextOpened') ? '75%' : 0);\n\n          LayoutPlatform.set('contentLeft',\n            LayoutPlatform.get('leftContextOpened') ? '75%' : (\n            LayoutPlatform.get('rightContextOpened') ? '-75%' : 0)\n          );\n          LayoutPlatform.set('contentRight',\n            LayoutPlatform.get('rightContextOpened') ? '75%' : (\n            LayoutPlatform.get('leftContextOpened') ? '-75%' : 0)\n          );\n\n          if (_groupedButtons.left) {\n            _groupedButtons.left.defaultMode();\n          }\n          if (_groupedButtons.right) {\n            _groupedButtons.right.defaultMode();\n          }\n\n          LayoutPlatform.set('screen', 'screen-tablet');\n        }\n        else if (screenWidth >= VIEWS.MOBILE) {\n          LayoutPlatform.set('leftContextWidth', LayoutPlatform.get('leftContextOpened') ? '100%' : 0);\n          LayoutPlatform.set('rightContextWidth', LayoutPlatform.get('rightContextOpened') ? '100%' : 0);\n\n          LayoutPlatform.set('contentLeft', 0);\n          LayoutPlatform.set('contentRight', 0);\n\n          if (_groupedButtons.left) {\n            _groupedButtons.left.compactMode();\n          }\n          if (_groupedButtons.right) {\n            _groupedButtons.right.compactMode();\n          }\n\n          LayoutPlatform.set('screen', 'screen-mobile');\n        }\n      }\n\n      var templateWidth = _$el.contentTemplate.outerWidth();\n\n      if (templateWidth >= VIEWS.DESKTOP) {\n        LayoutPlatform.set('contentMedia', 'media-desktop');\n      }\n      else if (templateWidth >= VIEWS.TABLET) {\n        LayoutPlatform.set('contentMedia', 'media-tablet');\n      }\n      else if (templateWidth >= VIEWS.MOBILE) {\n        LayoutPlatform.set('contentMedia', 'media-mobile');\n      }\n\n      _updateTitlePosition();\n\n      if (screen != LayoutPlatform.get('screen')) {\n        LayoutPlatform.fire('screen', {\n          screen: LayoutPlatform.get('screen')\n        });\n\n        setTimeout(function() {\n          LayoutPlatform.fire('afterScreen', {\n            screen: LayoutPlatform.get('screen')\n          });\n        }, 250);\n      }\n\n      if (contentMedia != LayoutPlatform.get('contentMedia')) {\n        LayoutPlatform.fire('contentMedia', {\n          contentMedia: LayoutPlatform.get('contentMedia')\n        });\n\n        setTimeout(function() {\n          LayoutPlatform.fire('afterContentMedia', {\n            contentMedia: LayoutPlatform.get('contentMedia')\n          });\n        }, 250);\n      }\n\n      LayoutPlatform.fire('resize');\n\n      setTimeout(function() {\n        LayoutPlatform.fire('afterResize');\n      }, 250);\n    }\n\n    function _closeContext(orientation) {\n      var panel = LayoutPlatform.findChild('data-pl-name', 'context-' + orientation);\n\n      panel.close();\n    }\n\n    function _registerGroupedButtonsEvents(orientation, component) {\n      _groupedButtons[orientation] = component;\n\n      component.on('beforeAction', _beforeButtonsAction);\n      component.on('beforeCompact', _beforeButtonsCompact);\n\n      _resize();\n\n      _groupedButtons[orientation].show();\n    }\n\n    function _registerContextEvents(orientation, component) {\n      _contexts[orientation] = component;\n\n      component.on('beforeOpen', function() {\n        LayoutPlatform.set(orientation + 'ContextOpened', true);\n\n        LayoutPlatform.fire(orientation + 'ContextOpened', {\n          opened: true\n        });\n\n        _resize(orientation);\n      });\n\n      component.on('close', function() {\n        LayoutPlatform.set(orientation + 'ContextOpened', false);\n\n        LayoutPlatform.fire(orientation + 'ContextOpened', {\n          opened: false\n        });\n\n        _resize();\n      });\n\n      component.on('closeIfGroupOpened', function(args) {\n        if (!args || !args.$group) {\n          return;\n        }\n\n        args.$group.removeClass('opened');\n      });\n    }\n\n    function _displayContextGroup(orientation, context, $context, $group) {\n      $context.find('.pl-group').removeClass('opened');\n\n      $group.addClass('opened');\n\n      var title = $group.attr('data-title');\n\n      if ($group.attr('data-no-title') == 'true') {\n        LayoutPlatform.set('context' + orientation + 'usetitle', false);\n        LayoutPlatform.set('context' + orientation + 'title', null);\n      }\n      else if (typeof title != 'undefined') {\n        LayoutPlatform.set('context' + orientation + 'usetitle', true);\n        LayoutPlatform.set('context' + orientation + 'title', title);\n      }\n\n      context.open();\n    }\n\n    function _beforeButtonsAction(args) {\n      if (!args || !args.button || (!args.button.context && !args.button.group)) {\n        return;\n      }\n\n      if (args.button.group) {\n        var beforeGroup = args.button.beforeGroup || function(context, $group, callback) {\n          callback();\n        };\n\n        ['left', 'right'].forEach(function(orientation) {\n          var context = _contexts[orientation],\n              $context = $(context.el),\n              $group = $context.find('[data-group=\"' + args.button.group + '\"]');\n\n          if (!$group.length) {\n            return;\n          }\n\n          if ($group.hasClass('opened')) {\n            return context.open();\n          }\n\n          beforeGroup(context, $group, function() {\n            if (context.isOpened()) {\n              context.closeContent(function() {\n                _displayContextGroup(orientation, context, $context, $group);\n              });\n            }\n            else {\n              _displayContextGroup(orientation, context, $context, $group);\n            }\n          });\n        });\n      }\n      else if (args.button.context) {\n        var context = _contexts[args.button.context];\n        if (!context) {\n          return;\n        }\n\n        var beforeContext = args.button.beforeContext || function(callback) {\n          callback();\n        };\n\n        beforeContext(context, function callback() {\n          context.open();\n        });\n      }\n    }\n\n    function _beforeButtonsCompact(args) {\n      if (!args || !args.button) {\n        return;\n      }\n\n      if (args.button == _groupedButtons.left) {\n        _groupedButtons.right[args.opened ? 'hide' : 'show']();\n      }\n      else if (args.button == _groupedButtons.right) {\n        _groupedButtons.left[args.opened ? 'hide' : 'show']();\n      }\n    }\n\n    var LayoutPlatform = component({\n          plName: 'pl-layout-platform',\n          data: $.extend(true, {\n            loaded: false,\n            titleShowed: true,\n            titleLeft: 50,\n            titleLeftOffset: -80,\n            titleBgLeftOffset: 0,\n            titleBgWidth: 0,\n            titleBgHeight: 0,\n            buttonsleft: [],\n            buttonsright: [],\n            contextlefttitle: '',\n            contextrighttitle: '',\n            contextleftusetitle: true,\n            contextrightusetitle: true,\n            leftContextWidth: 0,\n            rightContextWidth: 0,\n            leftContextOpened: false,\n            rightContextOpened: false,\n            contentLeft: 0,\n            contentRight: 0,\n            contentMedia: '',\n\n            crossleftcontext: function() {\n              _closeContext('left');\n            },\n            crossrightcontext: function() {\n              _closeContext('right');\n            }\n          }, data),\n\n          leftGroupedButtons: function() {\n            return _groupedButtons.left;\n          },\n          rightGroupedButtons: function() {\n            return _groupedButtons.right;\n          },\n\n          leftContext: function() {\n            return _contexts.left;\n          },\n          rightContext: function() {\n            return _contexts.right;\n          }\n        }),\n        Page = LayoutPlatform.parentRequire,\n        _$el = {\n          window: $(window),\n          platform: $(LayoutPlatform.el),\n          content: $(LayoutPlatform.el).find('.pl-layout-platform-content'),\n          contentTemplate: $(LayoutPlatform.el).find('.pl-layout-platform-content-template')\n        };\n\n    window.Ractive.bindUses(LayoutPlatform, ['mask']);\n\n    LayoutPlatform.observe('title-showed', function(value) {\n      value = value === false || value == 'false' ? false : true;\n\n      LayoutPlatform.set('titleShowed', value);\n    });\n\n    _$el.window.resize(_resize);\n\n    LayoutPlatform.on('teardown', function() {\n      _$el.window.off('resize', _resize);\n    });\n\n    _resize();\n\n    function _updateTitlePosition() {\n      if (!_$el.titleText) {\n        return;\n      }\n\n      var width = _$el.titleText.outerWidth(),\n          screen = LayoutPlatform.get('screen');\n\n      LayoutPlatform.set('titleEmpty', !width);\n      LayoutPlatform.set('titleLeft',\n        screen == 'screen-desktop' ? (\n          50 +\n          (LayoutPlatform.get('leftContextOpened') ? 12.5 : 0) -\n          (LayoutPlatform.get('rightContextOpened') ? 12.5 : 0)\n        ) : 50\n      );\n\n      LayoutPlatform.set('titleLeftOffset', !width ? -8 : -(width / 2));\n    }\n\n    function _updateTitleArea(height, open) {\n      LayoutPlatform.set('titleOpened', open);\n\n      if (open) {\n        var titleWidth = _$el.title.outerWidth() + 40;\n        LayoutPlatform.set('titleBgLeftOffset', titleWidth / 2);\n        LayoutPlatform.set('titleBgWidth', titleWidth);\n        LayoutPlatform.set('titleBgHeight', height + 30);\n      }\n      else {\n        LayoutPlatform.set('titleBgLeftOffset', 0);\n        LayoutPlatform.set('titleBgWidth', 0);\n      }\n    }\n\n    LayoutPlatform.on('titleOpen', function(args) {\n      _updateTitleArea(args.height, true);\n    });\n\n    LayoutPlatform.on('titleClose', function(args) {\n      _updateTitleArea(args.height, false);\n\n      setTimeout(_updateTitlePosition, 550);\n    });\n\n    LayoutPlatform.selectApp = function(name, fireFunc, callback) {\n      if (!Title) {\n        return;\n      }\n\n      Title.selectApp(name, fireFunc, callback);\n    };\n\n    LayoutPlatform.addApp = function(app, indexOrPosition) {\n      if (!Title) {\n        return;\n      }\n\n      Title.addTitle(app, indexOrPosition);\n    };\n\n    LayoutPlatform.removeApp = function(name) {\n      if (!Title) {\n        return;\n      }\n\n      Title.removeTitle(name);\n    };\n\n    setTimeout(function() {\n      if (data.onloaded) {\n        data.onloaded(LayoutPlatform);\n      }\n\n      LayoutPlatform.set('loaded', true);\n\n      var beforeRequire = data.beforerequire || function(l, callback) {\n        callback();\n      };\n\n      beforeRequire(LayoutPlatform, function() {\n        LayoutPlatform.set('beforerequire', null);\n        data.beforerequire = null;\n\n        LayoutPlatform.set('start', true);\n\n        LayoutPlatform.require().then(function() {\n          _registerGroupedButtonsEvents('left', LayoutPlatform.findChild('data-pl-name', 'buttons-left'));\n          _registerGroupedButtonsEvents('right', LayoutPlatform.findChild('data-pl-name', 'buttons-right'));\n\n          _registerContextEvents('left', LayoutPlatform.findChild('data-pl-name', 'context-left'));\n          _registerContextEvents('right', LayoutPlatform.findChild('data-pl-name', 'context-right'));\n\n          Title = LayoutPlatform.findChild('name', 'pl-dropdown-title');\n\n          _$el.title = _$el.platform.find('.pl-layout-title');\n          _$el.titleText = _$el.platform.find('.pl-layout-title h2 span');\n\n          _updateTitlePosition();\n\n          if (Title) {\n            Title.on('open', function(args) {\n              LayoutPlatform.fire('titleOpen', args);\n            });\n\n            Title.on('close', function(args) {\n              LayoutPlatform.fire('titleClose', args);\n            });\n\n            Title.on('titleSelected', function(args) {\n              var cls = Page.get('cls') || [];\n              cls = cls.filter(function(value) {\n                return value.indexOf('app-') !== 0;\n              });\n\n              cls.push('app-' + args.title.name\n                .toLowerCase()\n                .replace(/[^a-z0-9]/gi, '')\n              );\n\n              Page.set('cls', cls);\n            });\n\n            Title.fireSelected();\n          }\n\n          done();\n\n          setTimeout(function() {\n            _$el.platform.find('.pl-layout-mask').remove();\n          });\n        });\n      });\n    });\n  });\n\n})();\n"],"sourceRoot":"/source/"}